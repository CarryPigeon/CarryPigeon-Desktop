# 06｜页面规格：插件中心与必需插件门禁（Patchbay）

版本：v1.0  
日期：2026-01-31

依据：
- `docs/design/client/PLUGIN-CENTER-FLOWS.md`（状态机）
- `docs/design/protocol/PLUGIN-CATALOG-AND-ERRORS.md`（required 缺失错误）

## 1. 插件中心（/plugins）——模块机柜

布局：
- 左：Rack Filters（过滤器）
  - Search（name/plugin_id/domain）
  - Filter：All / Installed / Enabled / Failed / Updates / Required
  - Source：Server Catalog / Repo Catalog（默认优先 server）
- 右：Module Grid（模块卡片栅格）+ 选中后 Detail Drawer（详情抽屉）

模块卡片（ModuleCard）信息：
- 面板标题：插件名 + 版本
- 铭牌：plugin_id（mono，可复制）
- 端口：provides domains（彩色小端口）
- 标签：
  - REQUIRED（红色锁扣）
  - UPDATE（角标）
  - FAILED（熔断标记 + lastError 摘要）
- 操作按钮：
  - Install / Enable / Disable / Update / Uninstall / Detail

## 2. 安装/启用/更新进度（映射状态机）

Install：
- select_version → confirm → downloading → verifying_sha256 → unpacking → installed

Enable：
- enabling → enabled | failed

Update：
- check update → confirm（展示权限变化）→ install new → enable new → switch | rollback

UI 表达：
- 统一 `ModuleProgress` 组件：标题（当前步骤）+ 进度条 + 可展开错误详情
- 失败时保留旧版本可用：Detail Drawer 必须显示 “当前在用版本（currentVersion）”

## 3. required 安装向导（/required-setup）——供电锁扣

页面结构：
- 顶部：`POWER LATCH OPEN`（阻止登录原因说明）
- 中部：Checklist（缺失/已装/启用失败）
- 底部：按钮
  - 打开插件中心（Required 视图）
  - 重试检查
  - 更换服务器

成功条件（建议与状态机一致）：
- required 列表每个 plugin：`enabled=true && status="ok"` → 自动放行回登录页，并在顶部显示一次成功提示。
