## 代码规范约定（CarryPigeon-Desktop）

本项目目标是“代码即文档”：阅读代码即可理解模块职责、数据流与边界条件。

### 1) 注释语言与粒度

- **注释统一使用中文**，包括：
  - 模块级（Rust：`//!`；TS/Vue：文件头 `@fileoverview`）
  - 文件级（每个文件必须有“职责 + 边界”说明）
  - 方法级（public 与关键 private helper 都要说明输入/输出/副作用）
  - 常量级（业务常量必须解释来源与用途）
- 不要求为“自解释”的简单 getter/setter 写长注释；但凡涉及**协议/存储/并发/状态机/副作用**，必须写清楚。

### 2) 日志语言与格式

- **日志输出统一使用英文**，便于：
  - 跨端（WebView/Rust）统一检索
  - 与第三方系统/SDK 日志对齐
  - 在用户侧收集日志时减少歧义
- 前端请使用 `src/shared/utils/logger.ts` 提供的 `createLogger(scope)`，不要直接调用 `console.*`。
- Rust 请使用 `tracing` 系列宏（`info!` / `warn!` / `error!` / `debug!`），避免使用 `println!`（测试可例外）。

### 3) 文档化注释（结构化）

- TS/JSDoc：导出的函数/类型优先使用结构化 JSDoc（`@param` / `@returns`），与 ESLint 规则保持一致。
- Rustdoc：优先使用 `# 参数` / `# 返回值` / `# 说明`，并保持中文描述清晰可落地。

### 4) 冗余代码清理原则

- 优先删除“重复实现同一语义”的代码（例如重复 refresh 编排、重复 localStorage key 字符串）。
- 若暂时无法删除（存在调用方/兼容性），必须在注释中说明“为何保留 + 何时可删”。

