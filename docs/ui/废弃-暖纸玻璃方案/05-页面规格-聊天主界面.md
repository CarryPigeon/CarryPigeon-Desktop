# 05｜页面规格：聊天主界面（/chat）

> 说明：该方案已废弃，现行方案为 `docs/ui/方案A-插线板/文档索引.md`。

版本：v1.1  
日期：2026-01-31

现有实现：`src/features/chat/presentation/pages/MainPage.vue`

## 1. 版式（四栏 + 顶栏）

网格（现有 CSS）：
- 左 1：服务器栏（server rail）
- 左 2：频道栏（channel rail，含服务器信息卡 + 搜索 + 频道列表 + 用户区）
- 中：顶栏搜索 + 聊天消息区 + 输入区
- 右：成员列表

期望：在“密度”和“可扫视性”之间取平衡：
- rail 的背景更“结构化”（渐变/分割线），chat pane 更“内容优先”（淡背景）。

## 2. 频道列表（Channel Rail）

现有实现：
- `ChannelList.vue`：频道列表 + 搜索 + 右键菜单 + 拖拽宽度
- `ServerInfoCard.vue`：服务器信息卡（顶部）
- `UserComponent.vue`：当前用户区（底部）

交互口径：
- 搜索：
  - 本地匹配（已加入）
  - 远端匹配（未加入）：未接入接口时展示占位与说明（现有代码已预留）
- 右键菜单：
  - copyId/copyName/info 已有
  - pin/settings/notify/clear 等：可先只“展示不可用”状态（避免误导）

## 3. 消息区（Chat Pane）

现有实现：
- `ChatBox.vue`：滚动容器 + “回到底部”提示
- `MessageBubbleComponents.vue`：按时间排序 + 日期分隔 + 分组（5 分钟窗口）

PRD 要求补齐（7.2 / 6.3）：
- 未安装插件的未知 domain：
  - 优先展示 `preview`（服务端生成，PRD 6.3.1）
  - 无 preview → 展示“需要插件 X”卡片（不展示原始 data 全量）
  - 提供“一键安装插件”入口 → 跳到插件中心并定位 `plugin_id`

删除（PRD 6.2）：
- 删除后消息“直接消失”（不占位、不留墓碑）。

## 4. 输入区（Input Pane）

现有实现：`TextArea.vue`（可继续演进为 composer host）

PRD 要求（插件扩展）：
- P0：`Core:Text` 输入
- V2：插件 composer（按 domain 切换）

UI 规格（建议）：
- 左侧：domain 选择器（默认 Core:Text；插件提供时出现分组）
- 中间：输入（文本/插件 composer slot）
- 右侧：发送/附件（附件为 P1）
- 回复态：若 `reply_to_mid` 存在，输入区顶部出现“引用条”，可一键取消

## 5. 右侧成员栏（Members Rail）

现有实现：`ParticipantsList.vue` + `MemberContextMenu.vue`

交互口径：
- 右键菜单：复制信息/禁言（ignore 本地）/查看资料/提及
- 弱状态：加载失败时展示可重试（PRD 7.3）

## 6. 断线/重连提示（P0）

PRD 7.3：推送断连展示弱提示并自动补齐。

建议 UI：
- 顶栏右侧一个 “连接状态条”（窄高 20px）
  - Connected（青绿点）
  - Reconnecting（动画点）
  - Offline（橙/红，带“重试”）
