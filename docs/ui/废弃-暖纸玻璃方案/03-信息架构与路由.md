# 03｜信息架构与路由（IA & Router）

> 说明：该方案已废弃，现行方案为 `docs/ui/方案A-插线板/文档索引.md`。

版本：v1.1  
日期：2026-01-31  
目标：把 PRD 的主流程拆成“用户能到达的页面”，并对齐当前路由实现与待补齐部分。

## 1. 当前已存在路由（代码现状）

来源：`src/app/router.ts`

- `/`：登录（`LoginPage.vue`）
- `/chat`：聊天主界面（`MainPage.vue`）
- `/settings`：设置（`SettingPage.vue`）
- `/user_info`：用户资料新窗口（`UserInfoPage.vue`）
- `/channel-info`：频道信息新窗口（`ChannelInfoPage.vue`）
- `/user-info-popover`：用户 Popover（`UserPopoverPage.vue`）
- `/channel-info-popover`：频道 Popover（`ChannelPopoverPage.vue`）

## 2. PRD 必需但尚缺的页面（建议新增）

来自 PRD：
- required 插件安装向导（PRD 7.1）
- 插件中心（PRD 7.1 + `design/client/PLUGIN-CENTER-FLOWS.md`）
- 未装插件的消息降级引导（PRD 7.2，属于消息渲染态）

建议新增路由（命名可调，但需稳定可引用）：

- `/plugins`：插件中心（默认列表）
- `/plugins/required`：required 筛选视图（入口：required gate）
- `/plugins/detail/:pluginId`：插件详情（含权限、来源、错误、版本）
- `/required-setup`：required 安装向导（只负责“说明 + 一键跳转到 /plugins/required”）

## 3. Gate 规则（体验口径）

required gate（PRD 5.6 / 7.1）：

- 允许：连接/握手、获取服务器信息、获取插件目录、安装/启用插件。
- 禁止：所有登录相关动作（register/login/token-login）。

UI 表现：
- 登录页一旦收到 `reason="required_plugin_missing"`：
  - 不弹“不可理解”的错误 toast；
  - 直接切换到 `/required-setup`；
  - 把 `missing_plugins[]` 以“任务列表”呈现，并提供“去安装”。

## 4. 子窗口（Tauri Window）约定

现状：`src/main.ts` 通过 query 参数区分窗口类型并路由到对应页面。

约定（建议保持）：
- 主窗口：负责网络连接与 API 调用（子窗口通过事件桥请求/响应）。
- Popover：透明背景 + 自适应窗口大小（参考 `ChannelPopoverPage.vue`）。
