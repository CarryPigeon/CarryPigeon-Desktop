# 08｜状态与错误（P0 体验口径）

> 说明：该方案已废弃，现行方案为 `docs/ui/方案A-插线板/文档索引.md`。

版本：v1.1  
日期：2026-01-31  
依据：PRD 7.2 / 7.3 / 10（验收）

## 1. 连接失败（P0）

必须区分并给出可操作建议：

- 网络不可达：提示检查网络/地址，按钮：编辑服务器、重试
- 握手失败：提示服务器不兼容或 ECC 错误，按钮：编辑 ECC、查看服务器信息
- 版本不兼容：提示升级客户端/服务端
- 公钥校验失败（若启用）：提示安全风险，默认阻止继续并给出替换公钥入口

## 2. 登录失败（P0）

必须区分：
- 验证码错误：表单内提示 + 允许重新发送
- 账号不存在/注册流程：若产品支持注册，提供入口；否则明确提示联系管理员
- required 插件缺失：不当作错误；跳转 required 向导（PRD 7.1）

## 3. 拉取失败（P0）

频道列表/历史消息失败：
- 不阻塞进入框架：允许看到已缓存内容（若有）
- 显示“重试”按钮 + 最近一次失败原因（弱提示）

## 4. 推送断连（P0）

表现：
- 顶栏连接状态条从绿 → 橙（reconnecting）→ 红（offline）
- 恢复后自动拉取增量补齐，并显示一次 “已恢复连接” 的弱 toast（不打断输入）

## 5. 未装插件的消息降级（P0）

规则（PRD 7.2）：
- 优先显示 `preview`
- 无 preview：提示“此消息需要插件 X”
- 永不展示原始 `data` 全量（避免泄露）
- 提供“去安装”按钮，定位到插件中心该 plugin_id

## 6. 删除消息（硬删除，P0）

- 删除后本地列表立即移除（不显示占位）
- 历史拉取也不可再出现（由服务端保证；客户端不做“墓碑渲染”）
