# ADR-0002：客户端插件运行时（执行模型/加载方式/network 边界）

日期：2026-01-31  
状态：Accepted

## 背景
插件需要同时在 PC 与移动端运行，并提供自定义消息的输入（composer）与渲染（renderer）。需要在“实现效率/生态表达力/安全隔离”之间做取舍。

## 决策
1) 执行模型：v1 采用 **同进程 ESM 动态加载**。
2) 资源加载：插件下载后 **安装到本地**，通过应用内静态资源协议（例如 `app://`）加载，而非运行时远端加载。
3) `network` 权限边界：仅允许访问**当前 server_socket** 对应地址（及其明确的下载端点），禁止访问任意公网。

## 影响
- 插件能力以宿主注入 API 为准；宿主必须提供受控 `network` API，而非暴露不受控的 `fetch`。
- 后续如需强隔离，可规划 v2（iframe/Worker），但不得破坏 manifest/contract 的语义。

